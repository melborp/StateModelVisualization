<!--
 //---------------------------------------------------------------------
 // <copyright file="StateDiagramWitButton.html">
 //    This code is licensed under the MIT License.
 //    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF
 //    ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED
 //    TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A
 //    PARTICULAR PURPOSE AND NONINFRINGEMENT.
 // </copyright>
 // <summary>
 //   Part of the State Model Visualization VSO extension by the
 //     ALM Rangers.  This file displays the Visualize element in context menu of backlog.
 //  </summary>
 //---------------------------------------------------------------------
-->


<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8"/>
    <script src="sdk/scripts/VSS.SDK.min.js"></script>
</head>
<body>

    <script>
      VSS.init();

      var statesOnWorkitemForm = (function () {
          "use strict";
          return {
              // This is a callback that gets invoked when a user clicks the newly contributed menu item
              // The actionContext parameter contains context data surrounding the circumstances of this
              // action getting invoked.
              execute: function (actionContext) {
                  // Get the Web Context to create the uri to navigate to
                  var extensionContext = VSS.getExtensionContext();
                  // Navigate to the new View Assoicated Work Items hub.  fabrikam.build is the namespace of the app and build.items is the id of the hub.

                  var widthPercentage = 75;
                  var heightPercentage = 85;

                  var newWidth = parseInt((window.screen.width / 100 * widthPercentage).toString());
                  var newHeight = parseInt((window.screen.height / 100 * heightPercentage).toString());

                  var opts = {
                      width: newWidth,
                      height: newHeight,
                      title: "Work Item State Diagram",
                      buttons: null
                  };
                  var contributionConfig =
                      {
                          action: actionContext
                      };
                  VSS.getService(VSS.ServiceIds.Dialog).then(function(dlg) {
                      dlg.openDialog(extensionContext.publisherId + "." + extensionContext.extensionId + ".work-item-state-diagram-dialog", opts, contributionConfig);
                  });
              }
          };
      }());

      VSS.register("state-diagram-work-item-button", statesOnWorkitemForm);
    </script>
</body>
</html>
